<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-16">
  <title>WebGL - Experiment</title>
  <link rel="stylesheet" type="text/css" href="{{ static_url('style.css') }}">
  <script type="text/javascript" src="{{ static_url('gl-matrix.js') }}"></script>
  <script type="text/javascript" src="{{ static_url('jquery_min.js') }}"></script>
  <script type="text/javascript"  src="{{ static_url('init_webgl.js') }}"></script>
  <script type="text/javascript" src="{{ static_url('callbacks.js') }} "></script>
  <script type="text/javascript" src="{{ static_url('drawing_loop.js') }} "></script>
  <script type="text/javascript" src="{{ static_url('init_webpage.js') }} "></script>
</head>
<body>
  <div class="grid">
    <div id="drawing-surface">
      <canvas id="tree-surface" >
        Your browser does not support HTML5
      </canvas>
    </div>

    <div class="metadata-tabs">

      <div class="tab-options">
        <div>
          <button class="tabs" onclick="showMenu(event,'highlight-menu')">Highlight Tips</button>
        </div>
        <div>
          <button class="tabs" onclick="showMenu(event, 'collapse-menu')">Collapse Edges</button>
        </div>
      </div>

      <!-- highlight menu, visible by default-->
      <div class="menu" id="highlight-menu">
        <div>
          <select id = "highlight-options"></select>
        </div>

        <div>
          <input type = "button" value = "select" onclick = "selectHighlight()" />
          <input type = "color" id="color-selector"/>
        </div>

        <div class="text-field">
          <label for="lower-bound">Lower Bound</label>
          <input type="text" id="lower-bound">
        </div>

        <div class="text-field">
          <label for="upper-bound">Upper Bound</label>
          <input type="text" id="upper-bound">
        </div>

        <div class="text-field">
          <label for="category">Category Name</label>
          <input type="text" id="category">
        </div>
      </div>

      <!-- show collapse menu and hide others-->
      <div class="menu" id="collapse-menu">
        <div>
          <select class = "metadata-options"></select>
          <label for="range">Clade Collapsing</label>
          <input type="range" min="0" max="9" value="0" class="slider" id="collapse-range"> <span id="num">
        </div>
      </div>
    </div>


    <script>
    {
      let edgeMetadata;
      window.result = [];
      window.treeData = [];
      window.triangleData = [];
      $.getJSON(window.edgeURL, function(data) {
        edgeMetadata = data;
      }).done(function() {
        initWebPage(edgeMetadata);
        window.treeData = extractEdgeInfo(edgeMetadata);
        window.largeDim = normalizeTree(edgeMetadata);
        window.result = window.treeData.concat(window.triangleData);
        initWebGl();
        initCallbacks();
        draw();
      });

      let slider = $("#collapse-range")[0];
      let output = $("#num")[0];
      output.innerHTML = slider.value;

      slider.oninput = function() {
          output.innerHTML = this.value;
          collapseClades();
      }
    }
    </script>
    </body>
</html>
